#!/usr/bin/env python3

import os
import errno
import subprocess

FIFO = '/tmp/statusbar_vpn'

try:
  if os.path.isfile(FIFO):
    os.remove(FIFO)

  try:
    os.mkfifo(FIFO)
  except OSError as oe:
    if oe.errno != errno.EEXIST:
      raise

  print("VPN: Off", end='', flush=True)

  while True:
    with open(FIFO) as pipe:
      data = pipe.read().rstrip()
      print("VPN: {}".format(data), end='', flush=True)

except KeyboardInterrupt:
  pass

os.remove(FIFO)
